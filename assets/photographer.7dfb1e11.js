import{a as r,g as O,p as _}from"./api.2da13346.js";let l;l=null;const I='img, button,  input,  textarea, [tabindex]:not([tabindex="-1"])';let m=[],M=null;const E=e=>{e.key==="Escape"&&g()},C=e=>{e.preventDefault();let t=m.findIndex(o=>o===l.querySelector(":focus"));e.shiftKey===!0?t-=1:t+=1,t>=m.length&&(t=0),t<0&&(t=m.length-1),m[t].focus()};function g(){!l||(M!==null&&M.focus(),l.style.display="none",l.setAttribute("aria-hidden","true"),l.setAttribute("aria-modal","false"),l.removeEventListener("click",g),l.querySelector(".modal_close").removeEventListener("click",g),l.querySelector(".modal").removeEventListener("click",e=>e.stopPropagation()),l.removeEventListener("keydown",C),l.removeEventListener("keydown",E),l=null)}function T(){l=document.getElementById("contact_modal"),m=Array.from(l.querySelectorAll(I)),M=document.querySelector(":focus"),l.style.display="block",m[0].focus(),l.removeAttribute("aria-hidden"),l.setAttribute("aria-modal","true"),l.addEventListener("click",g),l.querySelector(".modal_close").addEventListener("click",g),l.querySelector(".modal").addEventListener("click",e=>e.stopPropagation()),l.addEventListener("keydown",C),l.addEventListener("keydown",E)}function P(e){const{id:t,photographerId:o,title:n,image:i,video:s,likes:u}=e,a=`assets/images/${o}/${i}`,d=`assets/images/${o}/${s}`,p=document.querySelector(".photographer_media-user");function b(){const f=r(p,"article","",{class:"product"});function c(){const v=r(f,"a","",{href:d}),A=r(v,"video","",{class:"product-video",controls:!0,preload:"metadata"});r(A,"source","",{src:`${d}#t=0.1`,type:"video/mp4"})}function h(){const v=r(f,"a","",{href:a});r(v,"img","",{class:"product-img",src:a,alt:n,id:t})}s?c():h();const y=r(f,"footer","",{class:"product-footer"});return y.innerHTML=`
        <p class="product-title">${n}</p>
        <span class="product-likes">${u}</span>
        <svg width="19" height="19" viewBox="0 0 19 19" class="product-heart" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M9.5 18.35L8.23125 17.03C3.725 12.36 0.75 9.28 0.75 5.5C0.75 2.42 2.8675 0 5.5625 0C7.085 0 8.54625 0.81 9.5 2.09C10.4537 0.81 11.915 0 13.4375 0C16.1325 0 18.25 2.42 18.25 5.5C18.25 9.28 15.275 12.36 10.7688 17.04L9.5 18.35Z" fill="currentcolor"/>
        </svg>
        `,f}return{getUserMediaDOM:b}}function $(e){return e.sort(({title:t},{title:o})=>t.localeCompare(o))}function H(e){return e.sort(({date:t},{date:o})=>new Date(t)-new Date(o))}function U(e){return e.sort(({likes:t},{likes:o})=>o-t)}function B(e){function t(n){const i=n.replace(/(?:^.*[\\/])|(?:\.[^.]+$)/g,"").replace(/_/g," ");console.log("replace",i);const s=document.querySelector(".lightbox_container");if(n.split(".")[1]==="mp4")s.innerHTML="",r(s,"video","",{class:"lightbox_video",controls:!0,src:n});else{s.innerHTML="",r(s,"div","",{class:"lightbox_loader"});const a=document.createElement("img");a.setAttribute("src",n),a.setAttribute("alt",i),a.setAttribute("class","lightbox_image"),a.onload=()=>{s.innerHTML="",s.appendChild(a)}}}function o(){const n=r(document.body,"div","",{class:"lightbox",role:"dialog","aria-hidden":"true","aria-modal":"false","aria-labelledby":"contact_modal_title",style:"display: block"});r(n,"button","",{class:"lightbox_close"}),r(n,"button","",{class:"lightbox_prev"}),r(n,"button","",{class:"lightbox_next"}),r(n,"div","",{id:"lightbox_container",class:"lightbox_container"});function i(c){c.preventDefault(),n.remove(),document.removeEventListener("click",i),document.removeEventListener("keydown",d)}function s(c){c.preventDefault();const h=document.querySelector("#lightbox_container").firstElementChild;return e.findIndex(y=>y===h.getAttribute("src"))}function u(c){let h=s(c);h===0&&(h=e.length),t(e[h-1])}function a(c){let h=s(c);h===e.length-1&&(h=-1),t(e[h+1])}function d(c){switch(c.key){case"Escape":i(c);break;case"ArrowLeft":u(c);break;case"ArrowRight":a(c);break}}return document.addEventListener("keydown",d),n.querySelector(".lightbox_close").addEventListener("click",i),n.querySelector(".lightbox_prev").addEventListener("click",u),n.querySelector(".lightbox_next").addEventListener("click",a),n}return{getLightboxDOM:o,getImageDOM:t}}function F(){function e(){const t=document.querySelector("#main"),o=r(t,"section","",{class:"photographer_media"}),n=document.createElement("span");n.classList.add("photographer_media_heading"),n.textContent="Trier par ",n.setAttribute("role","heading"),n.setAttribute("aria-level","2"),o.appendChild(n);const i=r(o,"div","",{class:"dropdown-menu"});r(o,"div","",{class:"photographer_media-user"}),r(i,"input","",{class:"dropdown-menu_switch",type:"checkbox",id:"filter-switch",name:"filter-switch",hidden:!0});const s=r(i,"label","",{class:"dropdown-menu_options-filter",for:"filter-switch"}),u=r(s,"ul","",{class:"dropdown-menu_filter",role:"listbox",tabindex:"0","aria-label":"filtrer les media par date ou popularit\xE9 ou par titre"});r(u,"li","Popularit\xE9",{class:"dropdown-menu_filter-selected",role:"option","aria-selected":"true"});const a=r(u,"li","",{}),d=r(a,"ul","",{class:"dropdown-menu_select",role:"listbox",tabindex:"0","aria-label":"filtrer les media par date ou popularit\xE9 ou par titre"});return r(d,"li","Popularit\xE9",{class:"dropdown-menu_select-option dropdown-menu_selected-option-hidden",role:"option",tabindex:"0","aria-label":"Popularit\xE9"}),r(d,"li","Date",{class:"dropdown-menu_select-option",role:"option",tabindex:"0","aria-label":"Date"}),r(d,"li","Titre",{class:"dropdown-menu_select-option",role:"option",tabindex:"0","aria-label":"Titre"}),o}return{getDropdownMenuDOM:e}}function V(e,t){function o(){const n=document.createElement("div");return n.classList.add("likes"),n.setAttribute("role","list"),n.setAttribute("aria-label","liste des likes"),n.innerHTML=`
                <span class="likes_count" role="listitem">${e.toLocaleString("fr")}</span>  
                <svg width="19" height="19" viewBox="0 0 19 19" class="likes_heart" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M9.5 18.35L8.23125 17.03C3.725 12.36 0.75 9.28 0.75 5.5C0.75 2.42 2.8675 0 5.5625 0C7.085 0 8.54625 0.81 9.5 2.09C10.4537 0.81 11.915 0 13.4375 0C16.1325 0 18.25 2.42 18.25 5.5C18.25 9.28 15.275 12.36 10.7688 17.04L9.5 18.35Z" fill="currentcolor"/>
                </svg>
                <span class="likes_price" role="listitem" aria-label="${t}\u20AC / jour">${t}\u20AC / jour</span>
            `,n}return{getLikesDOM:o}}function j(e,t){e.textContent=t}function x(e){j(e,parseInt(e.textContent,10)+1)}const w=document.querySelector("main"),D=()=>{const t=new URL(window.location.href).searchParams.get("id");return parseInt(t,10)},S=e=>{const t=D();return e.find(o=>o.id===t)};async function k(e){const t=document.querySelector(".photographer_media-user");e.forEach(o=>{const i=P(o).getUserMediaDOM();t.appendChild(i)})}async function K(e){const o=_(e).getUserHeaderDOM();w.appendChild(o)}function R(e){const o=_(e).getUserModalDOM();document.body.appendChild(o),document.querySelector(".modal_submit").addEventListener("click",n=>{n.preventDefault(),g()})}function Z(){const e=Array.from(document.querySelectorAll(".product a")),t=Array.from(new Set(e.map(o=>o.getAttribute("href"))));e.forEach(o=>o.addEventListener("click",n=>{n.preventDefault();const i=B(t),s=i.getLightboxDOM();i.getImageDOM(n.currentTarget.getAttribute("href")),document.body.appendChild(s)}))}function L(e){switch(document.querySelector(".dropdown-menu_filter-selected").textContent){case"Popularit\xE9":return U(e);case"Titre":return $(e);case"Date":return H(e);default:return e}}const q=e=>{const t=D();return e.filter(o=>o.photographerId===t)};function z(e){const{photographers:t,media:o}=e,{id:n}=S(t);let i=0;q(o).forEach(p=>{i+=p.likes});const{price:s}=t.find(p=>p.id===n),a=V(i,s).getLikesDOM();w.appendChild(a);const d=document.querySelector(".likes_count");document.querySelectorAll(".product-heart").forEach(p=>{p.addEventListener("click",b=>{b.preventDefault(),x(p.previousElementSibling),x(d)},{once:!0})})}function G(e,t){const o=e.currentTarget.textContent;t.textContent===o?t.classList.add("dropdown-menu_selected-option-hidden"):t.classList.remove("dropdown-menu_selected-option-hidden")}async function J(e){const o=F().getDropdownMenuDOM();w.appendChild(o);const n=document.querySelector(".dropdown-menu_filter-selected"),i=document.querySelectorAll(".dropdown-menu_select-option");await k(L(e)),i.forEach(s=>{s.addEventListener("click",u=>{n.textContent=u.currentTarget.textContent,i.forEach(p=>{G(u,p)});const a=document.querySelector(".photographer_media-user");for(;a.firstChild;)a.removeChild(a.firstChild);const d=L(e);k(d)})})}(async()=>{const{photographers:e,media:t}=await O(),o=S(e);await K(o),await R(o),await J(q(t)),Z(),z({photographers:e,media:t}),document.querySelector(".photographer_contact").addEventListener("click",T)})();
