import{p as w,a as u,g as O}from"./api.1af9f4fa.js";const S=e=>{const t=Array.from(e.querySelectorAll(' button:not([disabled]), [tabindex]:not([tabindex="-1"])')),n=t[0],o=t[t.length-1];e.addEventListener("keydown",c=>{(c.key==="Tab"||c.code==="9")&&(c.shiftKey?document.activeElement===n&&(o.focus(),c.preventDefault()):document.activeElement===o&&(n.focus(),c.preventDefault()))})};let p;p=null;const I="img, button,  input,  textarea";let E=[],y=null;const D=e=>{e.key==="Escape"&&h()};function h(){!p||(y!==null&&y.focus(),p.remove(),document.body.classList.remove("no-scroll"),p.removeEventListener("click",h),p.querySelector(".modal_close").removeEventListener("click",h),p.querySelector(".modal").removeEventListener("click",e=>e.stopPropagation()),p.removeEventListener("keydown",D),p=null)}function T(e){const n=w(e).getUserModalDOM();document.body.appendChild(n),p=document.getElementById("contact_modal"),E=Array.from(p.querySelectorAll(I)),y=document.querySelector(":focus"),document.body.className="no-scroll",document.querySelector("main").setAttribute("aria-hidden","true"),document.querySelector("header").setAttribute("aria-hidden","true"),E[0].focus(),p.addEventListener("click",h),p.querySelector(".modal_close").addEventListener("click",h),p.querySelector(".modal").addEventListener("click",o=>o.stopPropagation()),p.addEventListener("keydown",D),document.querySelector(".modal_close").focus(),S(n),document.querySelector("#modal_form").addEventListener("submit",function(o){o.preventDefault();const c=new FormData(this),s=Object.fromEntries(c);console.table(s),h()})}function j(e){const{photographerId:t,title:n,image:o,video:c,likes:s}=e,r=`assets/images/${t}/${o}`,i=`assets/images/${t}/${c}`,a=document.querySelector(".photographer_media");function d(){const b=u(a,"figure","",{class:"product"});function g(){const l=u(b,"video","",{class:"product-video",controls:"controls",preload:"metadata","aria-labelledBy":"product-title"});u(l,"source","",{src:`${i}#t=0.1`,type:"video/mp4",controls:"controls"})}function m(){u(b,"img","",{class:"product-img",src:r,alt:n,tabindex:0})}c?g():m();const x=u(b,"figcaption","",{class:"product-figcaption","aria-live":"polite",tabindex:0});return x.innerHTML=`
        ${n}
        <span class="product-likes" >${s}</span>
        <span id="product_likes">j'aime</span>
        <svg width="19" height="19" viewBox="0 0 19 19" class="product-heart" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M9.5 18.35L8.23125 17.03C3.725 12.36 0.75 9.28 0.75 5.5C0.75 2.42 2.8675 0 5.5625 0C7.085 0 8.54625 0.81 9.5 2.09C10.4537 0.81 11.915 0 13.4375 0C16.1325 0 18.25 2.42 18.25 5.5C18.25 9.28 15.275 12.36 10.7688 17.04L9.5 18.35Z" fill="currentcolor"/>
        </svg>
        
        
        `,b}return{getUserMediaDOM:d}}function B(e){return e.sort(({title:t},{title:n})=>t.localeCompare(n))}function F(e){return e.sort(({date:t},{date:n})=>new Date(t)-new Date(n))}function P(e){return e.sort(({likes:t},{likes:n})=>n-t)}function $(e){function t(o){const c=o.replace(/^.*[\\/]|\.[^.]+$/g,"").replace(/_/g," "),s=document.querySelector(".lightbox_figure"),r=o.split(".")[1];s.innerHTML="",r==="mp4"?u(s,"video","",{src:o,title:c,"aria-labelledBy":"lightbox_title",controls:!0,className:"lightbox_media"}):u(s,"img","",{class:"lightbox_media",src:o,alt:c,"aria-labelledBy":"lightbox_title"}),u(s,"figcaption",`${c}`,{class:"lightbox_title",id:"lightbox_title","aria-hidden":"true"})}function n(){const o=u(document.body,"div","",{class:"lightbox",role:"dialog","aria-hidden":"false","aria-modal":"true","aria-labelledBy":"lightbox_title"}),c=u(o,"div","",{id:"lightbox_container",class:"lightbox_container"});u(c,"figure","",{class:"lightbox_figure",tabindex:"0"}),u(o,"button","",{class:"lightbox_next",role:"button","aria-label":"Va au media suivant"}),u(o,"button","",{class:"lightbox_close",role:"button","aria-label":"Ferme la fen\xEAtre de dialogue"}),u(o,"button","",{class:"lightbox_prev",role:"button","aria-label":"Va au media pr\xE9c\xE9dent"});function s(l,f){l.preventDefault(),document.body.classList.remove("no-scroll"),o.remove(),document.querySelector("#main").removeAttribute("inert"),document.removeEventListener("keydown",d),document.removeEventListener("click",s),f.focus()}function r(l){l.preventDefault();const f=document.querySelector("#lightbox_container").firstElementChild.firstElementChild;return e.findIndex(C=>C===f.getAttribute("src"))}function i(l){let f=r(l);f===0&&(f=e.length),t(e[f-1])}function a(l){let f=r(l);f===e.length-1&&(f=-1),t(e[f+1])}function d(l){switch(l.key){case"Escape":s(l,g);break;case"ArrowLeft":i(l);break;case"ArrowRight":a(l);break}}o.addEventListener("keydown",d);const b=o.querySelector(".lightbox_close"),g=document.activeElement;return b.addEventListener("click",l=>{s(l,g)}),o.querySelector(".lightbox_prev").addEventListener("click",i),o.querySelector(".lightbox_next").addEventListener("click",a),o}return{getLightboxDOM:n,getImageDOM:t}}function H(){function e(){const r=document.querySelector("#main"),i=u(r,"section","",{class:"dropdown",role:"menu"});return i.innerHTML=`
            <label id="combo1-label" class="combo-label">Trier par </label>
            <div class="combo js-select">
              <div aria-controls="listbox1"
                   aria-expanded="false"
                   aria-haspopup="listbox"
                   aria-labelledby="combo1-label"
                   id="combo1"
                   class="combo-input"
                   role="combobox"
                   aria-activedescendant="combo1-0"
                   tabindex="0">
                   Popularit\xE9
              </div>
              <div class="combo-menu"
                   role="listbox"
                   id="listbox1"
                   aria-labelledby="combo1-label"
                   tabindex="-1">
                   <div role="option" id="combo1-0" class="combo-option option-current" aria-selected="true" tabindex="0">Popularit\xE9</div>
                   <div role="option" id="combo1-1" class="combo-option" aria-selected="false" tabindex="0">Date</div>
                   <div role="option" id="combo1-2" class="combo-option" aria-selected="false" tabindex="0">Titre</div>
              </div>
            </div>
        `,i}function t(){const r=document.querySelector(".js-select"),i=document.querySelector(".combo-input"),a=document.querySelector(".combo-menu"),d=document.querySelector(".option-current");r.classList.toggle("open"),i.addEventListener("keydown",o),a.addEventListener("mouseover",c),a.addEventListener("keydown",o),document.querySelector(".js-select").classList.contains("open")?(i.setAttribute("aria-expanded","true"),d.focus()):(i.setAttribute("aria-expanded","false"),i.focus())}function n(){const r=document.querySelector(".js-select"),i=document.querySelector(".combo-input"),a=document.querySelector(".combo-menu");r.classList.remove("open"),i.setAttribute("aria-expanded","false"),i.focus(),a.removeEventListener("mouseover",c),a.removeEventListener("keydown",o)}function o(r){const{key:i}=r;console.log(i);const a=document.querySelector(".combo-input"),d=Array.from(document.querySelectorAll(".combo-option")),b=document.querySelector(".option-current"),g=d.findIndex(m=>m===document.activeElement);switch(i){case"Escape":r.preventDefault(),n();break;case"Enter":case" ":{r.preventDefault(),document.querySelector(".js-select").classList.contains("open")?(Array.from(b.parentElement.children).forEach(m=>{m.removeAttribute("aria-selected")}),document.querySelector(".option-current").classList.remove("option-current"),document.activeElement.setAttribute("aria-selected","true"),document.activeElement.classList.add("option-current"),a.innerText=document.activeElement.innerText,a.setAttribute("aria-activedescendant",document.activeElement.id),n()):t();break}case"ArrowDown":{if(r.preventDefault(),document.querySelector(".js-select").classList.contains("open")){let m;g<d.length-1&&(m=document.activeElement.nextElementSibling),m&&m.focus()}break}case"ArrowUp":{if(r.preventDefault(),document.querySelector(".js-select").classList.contains("open")){let m;g>0&&(m=document.activeElement.previousElementSibling),m&&m.focus()}break}}}const c=r=>{r.preventDefault();const{target:i}=r;i.focus()};return{getDropdownDOM:e,openDropdown:t,onClick:r=>{const i=document.querySelector(".combo-input"),a=document.querySelector(".option-current");a.classList.remove("option-current"),a.removeAttribute("aria-selected"),i.textContent=r.textContent,r.classList.add("option-current"),r.setAttribute("aria-selected","true"),i.setAttribute("aria-activedescendant",r.id),t()},onKeyDown:o,onMouseOver:c}}function U(e,t){function n(){const o=document.createElement("aside");return o.classList.add("likes"),o.innerHTML=`
        <div class="likes_fixed" >
                <span id="likes_count" class="likes_count" role="alert" >${e.toLocaleString("fr")}</span><span id="likes">likes</span>  
                <svg width="19" height="19" viewBox="0 0 19 19" class="likes_heart" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M9.5 18.35L8.23125 17.03C3.725 12.36 0.75 9.28 0.75 5.5C0.75 2.42 2.8675 0 5.5625 0C7.085 0 8.54625 0.81 9.5 2.09C10.4537 0.81 11.915 0 13.4375 0C16.1325 0 18.25 2.42 18.25 5.5C18.25 9.28 15.275 12.36 10.7688 17.04L9.5 18.35Z" fill="currentcolor"/>
                </svg>
                <span id="likes_price">\xC9molument</span>
                <span class="likes_price">${t}\u20AC / jour</span>
        </div>
            `,o}return{getLikesDOM:n}}function V(e,t){console.log(e),e.textContent=t.toLocaleString("fr")}function L(e){V(e,parseInt(e.textContent,10)+1)}const v=document.querySelector("main"),q=()=>{const t=new URL(window.location.href).searchParams.get("id");return parseInt(t,10)},_=e=>{const t=q();return e.find(n=>n.id===t)};async function k(e){const t=document.createElement("section");t.className="photographer_media",t.setAttribute("aria-label","Media"),v.appendChild(t),e.forEach(n=>{const c=j(n).getUserMediaDOM();t.appendChild(c)})}async function K(e){const n=w(e).getUserHeaderDOM();v.appendChild(n)}function N(){const e=Array.from(document.querySelectorAll(".product-img")),t=Array.from(new Set(e.map(n=>n.getAttribute("src"))));e.forEach(n=>{n.addEventListener("click",o=>{o.preventDefault();const c=$(t),s=c.getLightboxDOM();c.getImageDOM(o.currentTarget.getAttribute("src")),document.body.appendChild(s),document.body.className="no-scroll",Array.from(document.body.children).filter(r=>r!==s).forEach(r=>r.setAttribute("inert","true")),document.querySelector(".lightbox_container>figure").focus(),S(s)})})}function M(e){switch(document.querySelector('[aria-selected="true"]').textContent){case"Popularit\xE9":return P(e);case"Titre":return B(e);case"Date":return F(e);default:return e}}const A=e=>{const t=q();return e.filter(n=>n.photographerId===t)};function R(e){const{photographers:t,media:n}=e,{id:o}=_(t);let c=0;A(n).forEach(d=>{c+=d.likes});const{price:s}=t.find(d=>d.id===o),i=U(c,s).getLikesDOM();v.appendChild(i);const a=document.querySelector(".likes_count");document.querySelectorAll(".product-heart").forEach(d=>{d.addEventListener("click",b=>{b.preventDefault();const g=b.target.parentElement.parentElement.firstElementChild;console.log("pl",g),L(g),L(a)},{once:!0})})}async function Z(e){const t=H(),n=t.getDropdownDOM();v.appendChild(n);const o=document.querySelector(".combo-input"),c=document.querySelectorAll(".combo-option");o.addEventListener("keydown",t.onKeyDown),o.addEventListener("click",t.openDropdown),new MutationObserver(()=>{document.querySelector(".photographer_media").remove();const r=M(e);k(r)}).observe(o,{attributes:!0,attributeFilter:["aria-activedescendant"]}),await k(M(e)),c.forEach(r=>{r.addEventListener("click",i=>t.onClick(i.target)),r.addEventListener("keydown",i=>t.onKeyDown(i.target))})}(async()=>{const{photographers:e,media:t}=await O(),n=_(e);await K(n),await Z(A(t)),N(),R({photographers:e,media:t}),document.querySelector(".photographer_contact").addEventListener("click",()=>T(n))})();
