import{a as s,g as O,p as E}from"./api.aab93edd.js";let i;i=null;const I='img, button,  input,  textarea, [tabindex]:not([tabindex="-1"])';let h=[],M=null;const D=e=>{e.key==="Escape"&&g()},S=e=>{e.preventDefault();let t=h.findIndex(n=>n===i.querySelector(":focus"));e.shiftKey===!0?t-=1:t+=1,t>=h.length&&(t=0),t<0&&(t=h.length-1),h[t].focus()};function g(){!i||(M!==null&&M.focus(),i.style.display="none",i.setAttribute("aria-hidden","true"),i.setAttribute("aria-modal","false"),i.removeEventListener("click",g),i.querySelector(".modal_close").removeEventListener("click",g),i.querySelector(".modal").removeEventListener("click",e=>e.stopPropagation()),i.removeEventListener("keydown",S),i.removeEventListener("keydown",D),i=null)}function P(){i=document.getElementById("contact_modal"),h=Array.from(i.querySelectorAll(I)),M=document.querySelector(":focus"),i.style.display="block",h[0].focus(),i.removeAttribute("aria-hidden"),i.setAttribute("aria-modal","true"),i.addEventListener("click",g),i.querySelector(".modal_close").addEventListener("click",g),i.querySelector(".modal").addEventListener("click",e=>e.stopPropagation()),i.addEventListener("keydown",S),i.addEventListener("keydown",D)}function T(e){const{id:t,photographerId:n,title:o,image:r,video:c,likes:p}=e,a=`assets/images/${n}/${r}`,m=`assets/images/${n}/${c}`,u=document.querySelector(".photographer_media-user");function f(){const b=s(u,"article","",{class:"product"});function l(){const x=s(b,"a","",{href:m}),A=s(x,"video","",{class:"product-video",controls:!0,preload:"metadata"});s(A,"source","",{src:`${m}#t=0.1`,type:"video/mp4"})}function d(){const x=s(b,"a","",{href:a});s(x,"img","",{class:"product-img",src:a,alt:o,id:t})}c?l():d();const y=s(b,"footer","",{class:"product-footer"});return y.innerHTML=`
        <p class="product-title">${o}</p>
        <span class="product-likes">${p}</span>
        <svg width="19" height="19" viewBox="0 0 19 19" class="product-heart" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M9.5 18.35L8.23125 17.03C3.725 12.36 0.75 9.28 0.75 5.5C0.75 2.42 2.8675 0 5.5625 0C7.085 0 8.54625 0.81 9.5 2.09C10.4537 0.81 11.915 0 13.4375 0C16.1325 0 18.25 2.42 18.25 5.5C18.25 9.28 15.275 12.36 10.7688 17.04L9.5 18.35Z" fill="currentcolor"/>
        </svg>
        `,b}return{getUserMediaDOM:f}}function H(e){return e.sort(({title:t},{title:n})=>t.localeCompare(n))}function $(e){return e.sort(({date:t},{date:n})=>new Date(t)-new Date(n))}function U(e){return e.sort(({likes:t},{likes:n})=>n-t)}function B(e){function t(o){const r=o.replace(/(?:^.*[\\/])|(?:\.[^.]+$)/g,"").replace(/_/g," ");console.log("replace",r);const c=document.querySelector(".lightbox_container");if(o.split(".")[1]==="mp4")c.innerHTML="",s(c,"video","",{class:"lightbox_video",controls:!0,src:o});else{c.innerHTML="",s(c,"div","",{class:"lightbox_loader"});const a=document.createElement("img");a.setAttribute("src",o),a.setAttribute("alt",r),a.setAttribute("class","lightbox_image"),a.onload=()=>{c.innerHTML="",c.appendChild(a)}}}function n(){const o=s(document.body,"div","",{class:"lightbox",role:"dialog","aria-hidden":"true","aria-modal":"false","aria-labelledby":"contact_modal_title",style:"display: block"});s(o,"button","",{class:"lightbox_close"}),s(o,"button","",{class:"lightbox_prev"}),s(o,"button","",{class:"lightbox_next"}),s(o,"div","",{id:"lightbox_container",class:"lightbox_container"});function r(l){l.preventDefault(),o.remove(),document.removeEventListener("click",r),document.removeEventListener("keydown",m)}function c(l){l.preventDefault();const d=document.querySelector("#lightbox_container").firstElementChild;return e.findIndex(y=>y===d.getAttribute("src"))}function p(l){let d=c(l);d===0&&(d=e.length),t(e[d-1])}function a(l){let d=c(l);d===e.length-1&&(d=-1),t(e[d+1])}function m(l){switch(l.key){case"Escape":r(l);break;case"ArrowLeft":p(l);break;case"ArrowRight":a(l);break}}return document.addEventListener("keydown",m),o.querySelector(".lightbox_close").addEventListener("click",r),o.querySelector(".lightbox_prev").addEventListener("click",p),o.querySelector(".lightbox_next").addEventListener("click",a),o}return{getLightboxDOM:n,getImageDOM:t}}function F(){function e(){const n=document.querySelector("#main"),o=s(n,"div","",{class:"dropdown"});return o.innerHTML=`
            <label id="combo1-label" class="combo-label">Trier par </label>
            <div class="combo js-select">
              <div aria-controls="listbox1"
                   aria-haspopup="listbox"
                   aria-labelledby="combo1-label"
                   id="combo1"
                   class="combo-input"
                   role="button"
                   tabindex="0">Popularit\xE9
              </div>
              <div class="combo-menu"
                   role="listbox"
                   id="listbox1"
                   >
                   <div role="option" class="combo-option option-current" aria-selected="true" aria-label="Popularit\xE9">Popularit\xE9</div>
                   <div role="option" class="combo-option" aria-selected="false" aria-label="Date" >Date</div>
                   <div role="option" class="combo-option" aria-selected="false" aria-label="Titre" >Titre</div>
              </div>
            </div>
        `,o}function t(){document.querySelector(".js-select").classList.toggle("open"),document.querySelector(".combo-input").toggleAttribute("aria-expanded"),document.querySelectorAll(".combo-option").forEach(o=>{o.toggleAttribute("aria-activedescendant")})}return{getDropdownDOM:e,openDropdown:t}}function V(e,t){function n(){const o=document.createElement("div");return o.classList.add("likes"),o.setAttribute("role","list"),o.setAttribute("aria-label","liste des likes"),o.innerHTML=`
        <div class="likes_fixed">
                <span class="likes_count" role="listitem">${e.toLocaleString("fr")}</span>  
                <svg width="19" height="19" viewBox="0 0 19 19" class="likes_heart" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M9.5 18.35L8.23125 17.03C3.725 12.36 0.75 9.28 0.75 5.5C0.75 2.42 2.8675 0 5.5625 0C7.085 0 8.54625 0.81 9.5 2.09C10.4537 0.81 11.915 0 13.4375 0C16.1325 0 18.25 2.42 18.25 5.5C18.25 9.28 15.275 12.36 10.7688 17.04L9.5 18.35Z" fill="currentcolor"/>
                </svg>
                <span class="likes_price" role="listitem" aria-label="${t}\u20AC / jour">${t}\u20AC / jour</span>
        </div>
            `,o}return{getLikesDOM:n}}function j(e,t){e.textContent=t.toLocaleString("fr")}function L(e){j(e,parseInt(e.textContent,10)+1)}const v=document.querySelector("main"),C=()=>{const t=new URL(window.location.href).searchParams.get("id");return parseInt(t,10)},_=e=>{const t=C();return e.find(n=>n.id===t)};async function k(e){const t=document.createElement("div");t.className="photographer_media",v.appendChild(t),e.forEach(n=>{const r=T(n).getUserMediaDOM();t.appendChild(r)})}async function K(e){const n=E(e).getUserHeaderDOM();v.appendChild(n)}function R(e){const n=E(e).getUserModalDOM();document.body.appendChild(n),document.querySelector(".modal_submit").addEventListener("click",o=>{o.preventDefault(),g()})}function Z(){const e=Array.from(document.querySelectorAll(".product a")),t=Array.from(new Set(e.map(n=>n.getAttribute("href"))));e.forEach(n=>n.addEventListener("click",o=>{o.preventDefault();const r=B(t),c=r.getLightboxDOM();r.getImageDOM(o.currentTarget.getAttribute("href")),document.body.appendChild(c)}))}function w(e){switch(document.querySelector(".option-current").textContent){case"Popularit\xE9":return U(e);case"Titre":return H(e);case"Date":return $(e);default:return e}}const q=e=>{const t=C();return e.filter(n=>n.photographerId===t)};function N(e){const{photographers:t,media:n}=e,{id:o}=_(t);let r=0;q(n).forEach(u=>{r+=u.likes});const{price:c}=t.find(u=>u.id===o),a=V(r,c).getLikesDOM();v.appendChild(a);const m=document.querySelector(".likes_count");document.querySelectorAll(".product-heart").forEach(u=>{u.addEventListener("click",f=>{f.preventDefault(),L(u.previousElementSibling),L(m)},{once:!0})})}function z(e){const t=e.textContent;e.value===t?e.classList.add("dropdown-menu_selected-option-hidden"):e.classList.remove("dropdown-menu_selected-option-hidden")}async function G(e){const t=F(),n=t.getDropdownDOM();v.appendChild(n);const o=document.querySelectorAll(".combo-option");await k(w(e)),document.querySelector("#combo1").addEventListener("click",t.openDropdown),o.forEach(r=>{r.addEventListener("click",()=>{o.forEach(a=>{a.classList.remove("option-current"),a.removeAttribute("aria-selected")}),z(r);const c=document.querySelector(".combo-input");c.textContent=r.textContent,c.setAttribute("aria-selected","true"),c.setAttribute("aria-label",r.textContent),r.classList.add("option-current"),r.setAttribute("aria-selected","true"),document.querySelector(".photographer_media").remove();const p=w(e);k(p)})})}(async()=>{const{photographers:e,media:t}=await O(),n=_(e);await K(n),await R(n),await G(q(t)),Z(),N({photographers:e,media:t}),document.querySelector(".photographer_contact").addEventListener("click",P)})();
