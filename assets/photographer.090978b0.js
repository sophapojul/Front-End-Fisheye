import{a as r,g as O,p as _}from"./api.f38faf45.js";let l;l=null;const I='img, button,  input,  textarea, [tabindex]:not([tabindex="-1"])';let m=[],M=null;const E=e=>{e.key==="Escape"&&f()},C=e=>{e.preventDefault();let t=m.findIndex(o=>o===l.querySelector(":focus"));e.shiftKey===!0?t-=1:t+=1,t>=m.length&&(t=0),t<0&&(t=m.length-1),m[t].focus()};function f(){!l||(M!==null&&M.focus(),l.style.display="none",l.setAttribute("aria-hidden","true"),l.setAttribute("aria-modal","false"),l.removeEventListener("click",f),l.querySelector(".modal_close").removeEventListener("click",f),l.querySelector(".modal").removeEventListener("click",e=>e.stopPropagation()),l.removeEventListener("keydown",C),l.removeEventListener("keydown",E),l=null)}function P(){l=document.getElementById("contact_modal"),m=Array.from(l.querySelectorAll(I)),M=document.querySelector(":focus"),l.style.display="block",m[0].focus(),l.removeAttribute("aria-hidden"),l.setAttribute("aria-modal","true"),l.addEventListener("click",f),l.querySelector(".modal_close").addEventListener("click",f),l.querySelector(".modal").addEventListener("click",e=>e.stopPropagation()),l.addEventListener("keydown",C),l.addEventListener("keydown",E)}function T(e){const{id:t,photographerId:o,title:n,image:s,video:i,likes:d}=e,a=`assets/images/${o}/${s}`,u=`assets/images/${o}/${i}`,h=document.querySelector(".photographer_media-user");function b(){const g=r(h,"article","",{class:"product"});function c(){const v=r(g,"a","",{href:u}),q=r(v,"video","",{class:"product-video",controls:!0,preload:"metadata"});r(q,"source","",{src:`${u}#t=0.1`,type:"video/mp4"})}function p(){const v=r(g,"a","",{href:a});r(v,"img","",{class:"product-img",src:a,alt:n,id:t})}i?c():p();const y=r(g,"footer","",{class:"product-footer"});return y.innerHTML=`
        <p class="product-title">${n}</p>
        <span class="product-likes">${d}</span>
        <svg width="19" height="19" viewBox="0 0 19 19" class="product-heart" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M9.5 18.35L8.23125 17.03C3.725 12.36 0.75 9.28 0.75 5.5C0.75 2.42 2.8675 0 5.5625 0C7.085 0 8.54625 0.81 9.5 2.09C10.4537 0.81 11.915 0 13.4375 0C16.1325 0 18.25 2.42 18.25 5.5C18.25 9.28 15.275 12.36 10.7688 17.04L9.5 18.35Z" fill="currentcolor"/>
        </svg>
        `,g}return{getUserMediaDOM:b}}function $(e){return e.sort(({title:t},{title:o})=>t.localeCompare(o))}function H(e){return e.sort(({date:t},{date:o})=>new Date(t)-new Date(o))}function U(e){return e.sort(({likes:t},{likes:o})=>o-t)}function B(e){function t(n){const s=n.replace(/^.*[\\/]/,"").replace(/\.[^.]+$/,"").replaceAll(/_/g," ");console.log("replace",s);const i=document.querySelector(".lightbox_container");if(n.split(".")[1]==="mp4")i.innerHTML="",r(i,"video","",{class:"lightbox_video",controls:!0,src:n});else{i.innerHTML="",r(i,"div","",{class:"lightbox_loader"});const a=document.createElement("img");a.setAttribute("src",n),a.setAttribute("alt",s),a.setAttribute("class","lightbox_image"),a.onload=()=>{i.innerHTML="",i.appendChild(a)}}}function o(){const n=r(document.body,"div","",{class:"lightbox",role:"dialog","aria-hidden":"true","aria-modal":"false","aria-labelledby":"contact_modal_title",style:"display: block"});r(n,"button","",{class:"lightbox_close"}),r(n,"button","",{class:"lightbox_prev"}),r(n,"button","",{class:"lightbox_next"}),r(n,"div","",{id:"lightbox_container",class:"lightbox_container"});function s(c){c.preventDefault(),n.remove(),document.removeEventListener("click",s),document.removeEventListener("keydown",u)}function i(c){c.preventDefault();const p=document.querySelector("#lightbox_container").firstElementChild;return e.findIndex(y=>y===p.getAttribute("src"))}function d(c){let p=i(c);p===0&&(p=e.length),t(e[p-1])}function a(c){let p=i(c);p===e.length-1&&(p=-1),t(e[p+1])}function u(c){switch(c.key){case"Escape":s(c);break;case"ArrowLeft":d(c);break;case"ArrowRight":a(c);break}}return document.addEventListener("keydown",u),n.querySelector(".lightbox_close").addEventListener("click",s),n.querySelector(".lightbox_prev").addEventListener("click",d),n.querySelector(".lightbox_next").addEventListener("click",a),n}return{getLightboxDOM:o,getImageDOM:t}}function F(){function e(){const t=document.querySelector("#main"),o=r(t,"section","",{class:"photographer_media"}),n=document.createElement("span");n.classList.add("photographer_media_heading"),n.textContent="Trier par ",n.setAttribute("role","heading"),n.setAttribute("aria-level","2"),o.appendChild(n);const s=r(o,"div","",{class:"dropdown-menu"});r(o,"div","",{class:"photographer_media-user"}),r(s,"input","",{class:"dropdown-menu_switch",type:"checkbox",id:"filter-switch",name:"filter-switch",hidden:!0});const i=r(s,"label","",{class:"dropdown-menu_options-filter",for:"filter-switch"}),d=r(i,"ul","",{class:"dropdown-menu_filter",role:"listbox",tabindex:"0","aria-label":"filtrer les media par date ou popularit\xE9 ou par titre"});r(d,"li","Popularit\xE9",{class:"dropdown-menu_filter-selected",role:"option","aria-selected":"true"});const a=r(d,"li","",{}),u=r(a,"ul","",{class:"dropdown-menu_select",role:"listbox",tabindex:"0","aria-label":"filtrer les media par date ou popularit\xE9 ou par titre"});return r(u,"li","Popularit\xE9",{class:"dropdown-menu_select-option",role:"option",tabindex:"0",style:"display: none;","aria-label":"Popularit\xE9"}),r(u,"li","Date",{class:"dropdown-menu_select-option",role:"option",tabindex:"0","aria-label":"Date"}),r(u,"li","Titre",{class:"dropdown-menu_select-option",role:"option",tabindex:"0","aria-label":"Titre"}),o}return{getDropdownMenuDOM:e}}function V(e,t){function o(){const n=document.createElement("div");return n.classList.add("likes"),n.setAttribute("role","list"),n.setAttribute("aria-label","liste des likes"),n.innerHTML=`
                <span class="likes_count" role="listitem">${e.toLocaleString("fr")}</span>  
                <svg width="19" height="19" viewBox="0 0 19 19" class="likes_heart" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M9.5 18.35L8.23125 17.03C3.725 12.36 0.75 9.28 0.75 5.5C0.75 2.42 2.8675 0 5.5625 0C7.085 0 8.54625 0.81 9.5 2.09C10.4537 0.81 11.915 0 13.4375 0C16.1325 0 18.25 2.42 18.25 5.5C18.25 9.28 15.275 12.36 10.7688 17.04L9.5 18.35Z" fill="currentcolor"/>
                </svg>
                <span class="likes_price" role="listitem" aria-label="${t}\u20AC / jour">${t}\u20AC / jour</span>
            `,n}return{getLikesDOM:o}}function j(e,t){e.textContent=t}function w(e){j(e,parseInt(e.textContent,10)+1)}const x=document.querySelector("main"),D=()=>{const t=new URL(window.location.href).searchParams.get("id");return parseInt(t,10)},S=e=>{const t=D();return e.find(o=>o.id===t)};async function k(e){const t=document.querySelector(".photographer_media-user");e.forEach(o=>{const s=T(o).getUserMediaDOM();t.appendChild(s)})}async function K(e){const o=_(e).getUserHeaderDOM();x.appendChild(o)}function N(e){const o=_(e).getUserModalDOM();document.body.appendChild(o),document.querySelector(".modal_submit").addEventListener("click",()=>{alert("Merci pour votre message !")})}function R(){const e=Array.from(document.querySelectorAll(".product a")),t=[...new Set(e.map(o=>o.getAttribute("href")))];e.forEach(o=>o.addEventListener("click",n=>{n.preventDefault();const s=B(t),i=s.getLightboxDOM();s.getImageDOM(n.currentTarget.getAttribute("href")),document.body.appendChild(i)}))}function L(e){switch(document.querySelector(".dropdown-menu_filter-selected").textContent){case"Popularit\xE9":return U(e);case"Titre":return $(e);case"Date":return H(e)}}const A=e=>{const t=D();return e.filter(o=>o.photographerId===t)};function Z(e){const{photographers:t,media:o}=e,{id:n}=S(t);let s=0;A(o).forEach(h=>{s+=h.likes});const{price:i}=t.find(h=>h.id===n),a=V(s,i).getLikesDOM();x.appendChild(a);const u=document.querySelector(".likes_count");document.querySelectorAll(".product-heart").forEach(h=>{h.addEventListener("click",b=>{b.preventDefault(),w(h.previousElementSibling),w(u)},{once:!0})})}async function z(e){const o=F().getDropdownMenuDOM();x.appendChild(o);const n=document.querySelector(".dropdown-menu_filter-selected"),s=document.querySelectorAll(".dropdown-menu_select-option");await k(L(e)),s.forEach(i=>{i.addEventListener("click",()=>{i.parentNode.childNodes.forEach(u=>{u.setAttribute("style","display: block")}),n.textContent=i.textContent,i.textContent===n.textContent?i.setAttribute("style","display: none;"):i.removeAttribute("style");const d=document.querySelector(".photographer_media-user");for(;d.firstChild;)d.removeChild(d.firstChild);const a=L(e);k(a)})})}(async()=>{const{photographers:e,media:t}=await O(),o=S(e);await K(o),await N(o),await z(A(t)),R(),Z({photographers:e,media:t}),document.querySelector(".photographer_contact").addEventListener("click",P)})();
