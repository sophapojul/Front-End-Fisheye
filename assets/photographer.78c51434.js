import{a as r,g as O,p as _}from"./api.2288d3d8.js";let s;s=null;const I='img, button,  input,  textarea, [tabindex]:not([tabindex="-1"])';let m=[],M=null;const E=e=>{e.key==="Escape"&&y()},C=e=>{e.preventDefault();let t=m.findIndex(o=>o===s.querySelector(":focus"));e.shiftKey===!0?t-=1:t+=1,t>=m.length&&(t=0),t<0&&(t=m.length-1),m[t].focus()};function y(){!s||(M!==null&&M.focus(),s.style.display="none",s.setAttribute("aria-hidden","true"),s.setAttribute("aria-modal","false"),s.removeEventListener("click",y),s.querySelector(".modal_close").removeEventListener("click",y),s.querySelector(".modal").removeEventListener("click",e=>e.stopPropagation()),s.removeEventListener("keydown",C),s.removeEventListener("keydown",E),s=null)}function P(){s=document.getElementById("contact_modal"),m=Array.from(s.querySelectorAll(I)),M=document.querySelector(":focus"),s.style.display="block",m[0].focus(),s.removeAttribute("aria-hidden"),s.setAttribute("aria-modal","true"),s.addEventListener("click",y),s.querySelector(".modal_close").addEventListener("click",y),s.querySelector(".modal").addEventListener("click",e=>e.stopPropagation()),s.addEventListener("keydown",C),s.addEventListener("keydown",E)}function $(e){const{id:t,photographerId:o,title:n,image:l,video:i,likes:d}=e,c=`assets/images/${o}/${l}`,u=`assets/images/${o}/${i}`,h=document.querySelector(".photographer_media-user");function g(){const f=r(h,"article","",{class:"product"});function a(){const b=r(f,"a","",{href:u}),A=r(b,"video","",{class:"product-video",controls:!0,preload:"metadata"});r(A,"source","",{src:`${u}#t=0.1`,type:"video/mp4"})}function p(){const b=r(f,"a","",{href:c});r(b,"img","",{class:"product-img",src:c,alt:n,id:t})}i?a():p();const v=r(f,"footer","",{class:"product-footer"});return v.innerHTML=`
        <p class="product-title">${n}</p>
        <span class="product-likes">${d}</span>
        <svg width="19" height="19" viewBox="0 0 19 19" class="product-heart" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M9.5 18.35L8.23125 17.03C3.725 12.36 0.75 9.28 0.75 5.5C0.75 2.42 2.8675 0 5.5625 0C7.085 0 8.54625 0.81 9.5 2.09C10.4537 0.81 11.915 0 13.4375 0C16.1325 0 18.25 2.42 18.25 5.5C18.25 9.28 15.275 12.36 10.7688 17.04L9.5 18.35Z" fill="currentcolor"/>
        </svg>
        `,f}return{getUserMediaDOM:g}}function H(e){return e.sort(({title:t},{title:o})=>t.localeCompare(o))}function T(e){return e.sort(({date:t},{date:o})=>new Date(t)-new Date(o))}function U(e){return e.sort(({likes:t},{likes:o})=>o-t)}function B(e){function t(n){const l=n.replace(/^.*[\\/]/,"").replace(/\.[^.]+$/,"").replaceAll(/_/g," ");console.log("replace",l);const i=document.querySelector(".lightbox_container");if(n.split(".")[1]==="mp4")i.innerHTML="",r(i,"video","",{class:"lightbox_video",controls:!0,src:n});else{i.innerHTML="",r(i,"div","",{class:"lightbox_loader"});const c=document.createElement("img");c.setAttribute("src",n),c.setAttribute("alt",l),c.setAttribute("class","lightbox_image"),c.onload=()=>{i.innerHTML="",i.appendChild(c)}}}function o(){const n=r(document.body,"div","",{class:"lightbox",role:"dialog","aria-hidden":"true","aria-modal":"false","aria-labelledby":"contact_modal_title",style:"display: block"});r(n,"button","",{class:"lightbox_close"}),r(n,"button","",{class:"lightbox_prev"}),r(n,"button","",{class:"lightbox_next"}),r(n,"div","",{id:"lightbox_container",class:"lightbox_container"});function l(a){a.preventDefault(),n.remove(),document.removeEventListener("click",l),document.removeEventListener("keydown",u)}function i(a){a.preventDefault();const p=document.querySelector("#lightbox_container").firstElementChild;return e.findIndex(v=>v===p.getAttribute("src"))}function d(a){let p=i(a);p===0&&(p=e.length),t(e[p-1])}function c(a){let p=i(a);p===e.length-1&&(p=-1),t(e[p+1])}function u(a){switch(a.key){case"Escape":l(a);break;case"ArrowLeft":d(a);break;case"ArrowRight":c(a);break}}return document.addEventListener("keydown",u),n.querySelector(".lightbox_close").addEventListener("click",l),n.querySelector(".lightbox_prev").addEventListener("click",d),n.querySelector(".lightbox_next").addEventListener("click",c),n}return{getLightboxDOM:o,getImageDOM:t}}function F(){function e(){const t=document.querySelector("#main"),o=r(t,"section","",{class:"photographer_media"}),n=document.createElement("span");n.classList.add("photographer_media_heading"),n.textContent="Trier par ",n.setAttribute("role","heading"),n.setAttribute("aria-level","2"),o.appendChild(n);const l=r(o,"div","",{class:"dropdown-menu"});r(o,"div","",{class:"photographer_media-user"}),r(l,"input","",{class:"dropdown-menu_switch",type:"checkbox",id:"filter-switch",name:"filter-switch",hidden:!0});const i=r(l,"label","",{class:"dropdown-menu_options-filter",for:"filter-switch"}),d=r(i,"ul","",{class:"dropdown-menu_filter",role:"listbox",tabindex:"-1"});r(d,"li","Popularit\xE9",{class:"dropdown-menu_filter-selected",role:"option","aria-selected":"true"});const c=r(d,"li","",{}),u=r(c,"ul","",{class:"dropdown-menu_select"});return r(u,"li","Popularit\xE9",{class:"dropdown-menu_select-option",role:"option"}),r(u,"li","Date",{class:"dropdown-menu_select-option",role:"option"}),r(u,"li","Titre",{class:"dropdown-menu_select-option",role:"option"}),o}return{getDropdownMenuDOM:e}}function V(e,t){function o(){const n=document.createElement("div");return n.classList.add("likes"),n.setAttribute("role","list"),n.setAttribute("aria-label","liste des likes"),n.innerHTML=`
                <span class="likes_count" role="listitem">${e.toLocaleString("fr")}</span>  
                <svg width="19" height="19" viewBox="0 0 19 19" class="likes_heart" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M9.5 18.35L8.23125 17.03C3.725 12.36 0.75 9.28 0.75 5.5C0.75 2.42 2.8675 0 5.5625 0C7.085 0 8.54625 0.81 9.5 2.09C10.4537 0.81 11.915 0 13.4375 0C16.1325 0 18.25 2.42 18.25 5.5C18.25 9.28 15.275 12.36 10.7688 17.04L9.5 18.35Z" fill="currentcolor"/>
                </svg>
                <span class="likes_price" role="listitem" aria-label="${t}\u20AC / jour">${t}\u20AC / jour</span>
            `,n}return{getLikesDOM:o}}function j(e,t){e.textContent=t}function x(e){j(e,parseInt(e.textContent,10)+1)}const w=document.querySelector("main"),D=()=>{const t=new URL(window.location.href).searchParams.get("id");return parseInt(t,10)},S=e=>{const t=D();return e.find(o=>o.id===t)};async function k(e){const t=document.querySelector(".photographer_media-user");e.forEach(o=>{const l=$(o).getUserMediaDOM();t.appendChild(l)})}async function K(e){const o=_(e).getUserHeaderDOM();w.appendChild(o)}function R(e){const o=_(e).getUserModalDOM();document.body.appendChild(o)}function Z(){const e=Array.from(document.querySelectorAll(".product a")),t=[...new Set(e.map(o=>o.getAttribute("href")))];e.forEach(o=>o.addEventListener("click",n=>{n.preventDefault();const l=B(t),i=l.getLightboxDOM();l.getImageDOM(n.currentTarget.getAttribute("href")),document.body.appendChild(i)}))}function L(e){switch(document.querySelector(".dropdown-menu_filter-selected").textContent){case"Popularit\xE9":return U(e);case"Titre":return H(e);case"Date":return T(e)}}const q=e=>{const t=D();return e.filter(o=>o.photographerId===t)};function z(e){const{photographers:t,media:o}=e,{id:n}=S(t);let l=0;q(o).forEach(h=>{l+=h.likes});const{price:i}=t.find(h=>h.id===n),c=V(l,i).getLikesDOM();w.appendChild(c);const u=document.querySelector(".likes_count");document.querySelectorAll(".product-heart").forEach(h=>{h.addEventListener("click",g=>{g.preventDefault(),console.log(g),x(h.previousElementSibling),x(u)})})}async function G(e){const o=F().getDropdownMenuDOM();w.appendChild(o);const n=document.querySelector(".dropdown-menu_filter-selected");document.querySelectorAll(".dropdown-menu_select-option").forEach(i=>{i.addEventListener("click",()=>{n.textContent=i.textContent})}),await k(L(e)),document.querySelectorAll(".dropdown-menu_select-option").forEach(i=>{i.addEventListener("click",()=>{const d=document.querySelector(".photographer_media-user");for(;d.firstChild;)d.removeChild(d.firstChild);const c=L(e);k(c)})})}(async()=>{const{photographers:e,media:t}=await O(),o=S(e);await K(o),await R(o),await G(q(t)),Z(),z({photographers:e,media:t}),document.querySelector(".photographer_contact").addEventListener("click",P)})();
