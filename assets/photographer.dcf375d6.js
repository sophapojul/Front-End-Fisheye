import{p as q,a as u,g as $}from"./api.320aea19.js";const A=e=>{const t=Array.from(e.querySelectorAll(' button:not([disabled]), [tabindex]:not([tabindex="-1"])')),n=t[0],o=t[t.length-1];e.addEventListener("keydown",r=>{(r.key==="Tab"||r.code==="9")&&(r.shiftKey?document.activeElement===n&&(o.focus(),r.preventDefault()):document.activeElement===o&&(n.focus(),r.preventDefault()))})};let b;b=null;const T="img, button,  input,  textarea";let k=[],x=null;function h(){!b||(x!==null&&x.focus(),b.remove(),document.body.classList.remove("no-scroll"),b.removeEventListener("click",h),b.querySelector(".modal_close").removeEventListener("click",h),b.querySelector(".modal").removeEventListener("click",e=>e.stopPropagation()),b.removeEventListener("keydown",C),b=null)}const C=e=>{e.key==="Escape"&&h()};function j(e){const n=q(e).getUserModalDOM();document.body.appendChild(n),b=document.getElementById("contact_modal"),k=Array.from(b.querySelectorAll(T)),x=document.querySelector(":focus"),document.body.className="no-scroll",document.querySelector("main").setAttribute("aria-hidden","true"),document.querySelector("header").setAttribute("aria-hidden","true"),k[0].focus(),b.addEventListener("click",h),b.querySelector(".modal_close").addEventListener("click",h),b.querySelector(".modal").addEventListener("click",o=>o.stopPropagation()),b.addEventListener("keydown",C),document.querySelector(".modal_close").focus(),A(n),document.querySelector("#modal_form").addEventListener("submit",function(o){o.preventDefault();const r=new FormData(this),s=Object.fromEntries(r);console.table(s),h()})}function B(e){const{photographerId:t,title:n,image:o,video:r,likes:s}=e,c=`assets/images/${t}/${o}`,i=`assets/images/${t}/${r}`,a=document.querySelector(".photographer_media");function l(){const m=u(a,"figure","",{class:"product"});function g(){const d=u(m,"video","",{class:"product-video",controls:"controls",preload:"metadata","aria-labelledBy":"product-title",src:`${i}`,tabindex:"0"});u(d,"source","",{src:`${i}#t=0.1`,type:"video/mp4",controls:"controls"})}function p(){u(m,"img","",{class:"product-img",src:c,alt:n,tabindex:"0"})}r?g():p();const E=u(m,"figcaption","",{class:"product-figcaption"});return E.innerHTML=`
        ${n}
        <span class="product-likes">${s}</span>
        <svg width="19" height="19" viewBox="0 0 19 19" class="product-heart" tabindex="0" aria-label="${s} likes" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M9.5 18.35L8.23125 17.03C3.725 12.36 0.75 9.28 0.75 5.5C0.75 2.42 2.8675 0 5.5625 0C7.085 0 8.54625 0.81 9.5 2.09C10.4537 0.81 11.915 0 13.4375 0C16.1325 0 18.25 2.42 18.25 5.5C18.25 9.28 15.275 12.36 10.7688 17.04L9.5 18.35Z" fill="currentcolor"/>
        </svg>
        `,m}return{getUserMediaDOM:l}}function F(e){return e.sort(({title:t},{title:n})=>t.localeCompare(n))}function P(e){return e.sort(({date:t},{date:n})=>new Date(t)-new Date(n))}function H(e){return e.sort(({likes:t},{likes:n})=>n-t)}function U(e){function t(o){const r=o.replace(/^.*[\\/]|\.[^.]+$/g,"").replace(/_/g," "),s=document.querySelector(".lightbox_figure"),c=o.split(".")[1];s.innerHTML="",c==="mp4"?u(s,"video","",{src:o,title:r,"aria-labelledBy":"lightbox_title",controls:!0,className:"lightbox_media"}):u(s,"img","",{class:"lightbox_media",src:o,alt:r,"aria-labelledBy":"lightbox_title"}),u(s,"figcaption",`${r}`,{class:"lightbox_title",id:"lightbox_title","aria-hidden":"true"})}function n(){const o=u(document.body,"div","",{class:"lightbox",role:"dialog","aria-hidden":"false","aria-modal":"true","aria-labelledBy":"lightbox_title"}),r=u(o,"div","",{id:"lightbox_container",class:"lightbox_container"});u(r,"figure","",{class:"lightbox_figure",tabindex:"0"}),u(o,"button","",{class:"lightbox_next",role:"button","aria-label":"Va au media suivant"}),u(o,"button","",{class:"lightbox_close",role:"button","aria-label":"Ferme la fen\xEAtre de dialogue"}),u(o,"button","",{class:"lightbox_prev",role:"button","aria-label":"Va au media pr\xE9c\xE9dent"});function s(d,f){d.preventDefault(),document.body.classList.remove("no-scroll"),o.remove(),document.querySelectorAll("[inert]").forEach(v=>{v.removeAttribute("inert")}),document.removeEventListener("keydown",l),document.removeEventListener("click",s),f.focus()}function c(d){d.preventDefault();const f=document.querySelector("#lightbox_container").firstElementChild.firstElementChild;return e.findIndex(v=>v===f.getAttribute("src"))}function i(d){let f=c(d);f===0&&(f=e.length),t(e[f-1])}function a(d){let f=c(d);f===e.length-1&&(f=-1),t(e[f+1])}function l(d){switch(d.key){case"Escape":s(d,g);break;case"ArrowLeft":i(d);break;case"ArrowRight":a(d);break}}o.addEventListener("keydown",l);const m=o.querySelector(".lightbox_close"),g=document.activeElement;return m.addEventListener("click",d=>{s(d,g)}),o.querySelector(".lightbox_prev").addEventListener("click",i),o.querySelector(".lightbox_next").addEventListener("click",a),o}return{getLightboxDOM:n,getImageDOM:t}}function V(){function e(){const c=document.querySelector("#main"),i=u(c,"section","",{class:"dropdown"});return i.innerHTML=`
            <label id="combo1-label" class="combo-label">Trier par </label>
            <div class="combo js-select">
              <div aria-controls="listbox1"
                   aria-expanded="false"
                   aria-haspopup="listbox"
                   aria-labelledby="combo1-label"
                   id="combo1"
                   class="combo-input"
                   role="combobox"
                   aria-activedescendant="combo1-0"
                   tabindex="0">
                   Popularit\xE9
              </div>
              <div class="combo-menu"
                   role="listbox"
                   id="listbox1"
                   aria-labelledby="combo1-label"
                   tabindex="-1">
                   <div role="option" id="combo1-0" class="combo-option option-current" aria-selected="true" tabindex="0">Popularit\xE9</div>
                   <div role="option" id="combo1-1" class="combo-option" aria-selected="false" tabindex="0">Date</div>
                   <div role="option" id="combo1-2" class="combo-option" aria-selected="false" tabindex="0">Titre</div>
              </div>
            </div>
        `,i}function t(){const c=document.querySelector(".js-select"),i=document.querySelector(".combo-input"),a=document.querySelector(".combo-menu"),l=document.querySelector(".option-current");c.classList.toggle("open"),i.addEventListener("keydown",o),a.addEventListener("mouseover",r),a.addEventListener("keydown",o),document.querySelector(".js-select").classList.contains("open")?(i.setAttribute("aria-expanded","true"),l.focus()):(i.setAttribute("aria-expanded","false"),i.focus())}function n(){const c=document.querySelector(".js-select"),i=document.querySelector(".combo-input"),a=document.querySelector(".combo-menu");c.classList.remove("open"),i.setAttribute("aria-expanded","false"),i.focus(),a.removeEventListener("mouseover",r),a.removeEventListener("keydown",o)}function o(c){const{key:i}=c,a=document.querySelector(".combo-input"),l=Array.from(document.querySelectorAll(".combo-option")),m=document.querySelector(".option-current"),g=l.findIndex(p=>p===document.activeElement);switch(i){case"Escape":c.preventDefault(),n();break;case"Enter":case" ":{c.preventDefault(),document.querySelector(".js-select").classList.contains("open")?(Array.from(m.parentElement.children).forEach(p=>{p.removeAttribute("aria-selected")}),document.querySelector(".option-current").classList.remove("option-current"),document.activeElement.setAttribute("aria-selected","true"),document.activeElement.classList.add("option-current"),a.innerText=document.activeElement.innerText,a.setAttribute("aria-activedescendant",document.activeElement.id),n()):t();break}case"ArrowDown":{if(c.preventDefault(),document.querySelector(".js-select").classList.contains("open")){let p;g<l.length-1&&(p=document.activeElement.nextElementSibling),p&&p.focus()}break}case"ArrowUp":{if(c.preventDefault(),document.querySelector(".js-select").classList.contains("open")){let p;g>0&&(p=document.activeElement.previousElementSibling),p&&p.focus()}break}}}const r=c=>{c.preventDefault();const{target:i}=c;i.focus()};return{getDropdownDOM:e,openDropdown:t,onClick:c=>{const i=document.querySelector(".combo-input"),a=document.querySelector(".option-current");a.classList.remove("option-current"),a.removeAttribute("aria-selected"),i.textContent=c.textContent,c.classList.add("option-current"),c.setAttribute("aria-selected","true"),i.setAttribute("aria-activedescendant",c.id),t()},onKeyDown:o,onMouseOver:r}}function K(e,t){function n(){const o=document.createElement("aside");return o.classList.add("likes"),o.setAttribute("role","complementary"),o.innerHTML=`
        <div class="likes_fixed" role="list">
                <span id="likes_count" class="likes_count" aria-live="polite" aria-label="total de ${e.toLocaleString("fr")} likes">${e.toLocaleString("fr")}<span class="likes">likes</span></span>
                <svg width="19" height="19" viewBox="0 0 19 19" class="likes_heart" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M9.5 18.35L8.23125 17.03C3.725 12.36 0.75 9.28 0.75 5.5C0.75 2.42 2.8675 0 5.5625 0C7.085 0 8.54625 0.81 9.5 2.09C10.4537 0.81 11.915 0 13.4375 0C16.1325 0 18.25 2.42 18.25 5.5C18.25 9.28 15.275 12.36 10.7688 17.04L9.5 18.35Z" fill="currentcolor"/>
                </svg>
                <span class="likes_price" role="listitem" aria-label="\xC9molument ${t}\u20AC / jour">${t}\u20AC / jour</span>
        </div>
            `,o}return{getLikesDOM:n}}function N(e,t){e.textContent=t.toLocaleString("fr")}function L(e){N(e,parseInt(e.textContent,10)+1)}const y=document.querySelector("main"),_=()=>{const t=new URL(window.location.href).searchParams.get("id");return parseInt(t,10)},O=e=>{const t=_();return e.find(n=>n.id===t)};async function w(e){const t=document.createElement("section");t.className="photographer_media",t.setAttribute("aria-label","Media"),y.appendChild(t),e.forEach(n=>{const r=B(n).getUserMediaDOM();t.appendChild(r)})}async function R(e){const n=q(e).getUserHeaderDOM();y.appendChild(n)}function M(e,t){e.preventDefault();const n=U(t),o=n.getLightboxDOM();n.getImageDOM(e.currentTarget.getAttribute("src")),document.body.appendChild(o),document.body.className="no-scroll",Array.from(document.body.children).filter(r=>r!==o).forEach(r=>r.setAttribute("inert","true")),document.querySelector(".lightbox_container>figure").focus(),A(o)}function Z(){const e=Array.from(document.querySelectorAll(".product>*:not(figcaption)")),t=Array.from(new Set(e.map(n=>n.getAttribute("src"))));e.forEach(n=>{n.addEventListener("click",o=>M(o,t)),n.addEventListener("keydown",o=>{(o.key==="Enter"||o.key===" ")&&M(o,t)})})}function S(e){switch(document.querySelector('[aria-selected="true"]').textContent){case"Popularit\xE9":return H(e);case"Titre":return F(e);case"Date":return P(e);default:return e}}const I=e=>{const t=_();return e.filter(n=>n.photographerId===t)};function D(e,t){e.preventDefault();const n=document.querySelector(".likes_count");L(t),L(n)}function z(e){const{photographers:t,media:n}=e,{id:o}=O(t);let r=0;I(n).forEach(a=>{r+=a.likes});const{price:s}=t.find(a=>a.id===o),i=K(r,s).getLikesDOM();y.appendChild(i),document.querySelectorAll(".product-heart").forEach(a=>{a.addEventListener("click",l=>{const m=l.target.parentElement.parentElement.firstElementChild;D(l,m),a.setAttribute("aria-label",`${m.textContent} likes`)},{once:!0}),a.addEventListener("keydown",l=>{if(l.key==="Enter"||l.key===" "){const m=l.target.parentElement.firstElementChild;D(l,m),a.setAttribute("aria-label",`${m.textContent} likes`)}})})}async function G(e){const t=V(),n=t.getDropdownDOM();y.appendChild(n);const o=document.querySelector(".combo-input"),r=document.querySelectorAll(".combo-option");o.addEventListener("keydown",t.onKeyDown),o.addEventListener("click",t.openDropdown),new MutationObserver(()=>{document.querySelector(".photographer_media").remove();const c=S(e);w(c)}).observe(o,{attributes:!0,attributeFilter:["aria-activedescendant"]}),await w(S(e)),r.forEach(c=>{c.addEventListener("click",i=>t.onClick(i.target)),c.addEventListener("keydown",i=>t.onKeyDown(i.target))})}(async()=>{const{photographers:e,media:t}=await $(),n=O(e);await R(n),await G(I(t)),Z(),z({photographers:e,media:t}),document.querySelector("header>a").addEventListener("keydown",r=>{(r.key==="Enter"||r.key===" ")&&(r.preventDefault(),window.location.href="/")}),document.querySelector(".photographer_contact").addEventListener("click",()=>j(n))})();
